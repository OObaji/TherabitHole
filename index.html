<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Rabbit Hole</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        /* Hide scrollbar for Chrome, Safari and Opera */
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        /* Hide scrollbar for IE, Edge and Firefox */
        .scrollbar-hide {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .slide-up { animation: slideUp 0.5s ease-out; }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        slate: {
                            750: '#2d3748', /* Custom for hover state approximation */
                            950: '#020617',
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-slate-950 text-slate-100 selection:bg-indigo-500/30">

    <div id="app" class="min-h-screen flex flex-col">
        <!-- Content injected by JS -->
    </div>

    <!-- Modal Container -->
    <div id="modal-container" class="relative z-[100] hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="fixed inset-0 bg-slate-950/80 backdrop-blur-sm transition-opacity" onclick="closeModal()"></div>
        <div class="fixed inset-0 z-10 overflow-y-auto">
            <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
                <div class="relative transform overflow-hidden rounded-2xl bg-slate-900 text-left shadow-2xl transition-all sm:my-8 sm:w-full sm:max-w-lg border border-slate-800" onclick="event.stopPropagation()">
                    <div id="modal-content"></div>
                </div>
            </div>
        </div>
    </div>

<script>
    // --- DATA ---
    const RAW_INTERESTS = [
      { id: 1, title: "Lockpicking", category: "Skill", difficulty: "Medium", cost: "$", desc: "The art of opening locks without the original key. A puzzle-solving skill that teaches mechanics and patience." },
      { id: 2, title: "Mycology", category: "Nature", difficulty: "Hard", cost: "$", desc: "The study of fungi. Foraging for mushrooms, identifying species, and understanding the wood wide web." },
      { id: 3, title: "Modular Synths", category: "Tech", difficulty: "Expert", cost: "$$$", desc: "Creating music by physically patching cables between distinct electronic modules. Sound design at its most raw." },
      { id: 4, title: "Kintsugi", category: "Art", difficulty: "Medium", cost: "$$", desc: "Japanese art of repairing broken pottery with lacquer dusted or mixed with powdered gold. Embracing flaws." },
      { id: 5, title: "Magnet Fishing", category: "Outdoors", difficulty: "Easy", cost: "$", desc: "Using strong neodymium magnets to retrieve ferromagnetic objects from outdoor waters." },
      { id: 6, title: "Conlanging", category: "Intellectual", difficulty: "Hard", cost: "Free", desc: "Constructing languages. Creating your own grammar, vocabulary, and script, like Elvish or Klingon." },
      { id: 7, title: "Urban Exploration", category: "Adventure", difficulty: "Medium", cost: "Free", desc: "Exploring man-made structures, usually abandoned ruins or not usually seen components of the man-made environment." },
      { id: 8, title: "Sourdough Baking", category: "Culinary", difficulty: "Medium", cost: "$", desc: "Baking bread using naturally occurring lactobacilli and yeast. It requires keeping a 'starter' alive." },
      { id: 9, title: "Geocaching", category: "Adventure", difficulty: "Easy", cost: "Free", desc: "An outdoor recreational activity, in which participants use a GPS receiver or mobile device and other navigational techniques to hide and seek containers." },
      { id: 10, title: "Whittling", category: "Craft", difficulty: "Easy", cost: "$", desc: "Carving shapes out of raw wood using a knife. A meditative and portable hobby." },
      { id: 11, title: "Astrophotography", category: "Tech", difficulty: "Hard", cost: "$$$", desc: "Photography of astronomical objects, celestial events, and areas of the night sky." },
      { id: 12, title: "Falconry", category: "Nature", difficulty: "Expert", cost: "$$$", desc: "The hunting of wild animals in their natural state and habitat by means of a trained bird of prey." },
      { id: 13, title: "Lucid Dreaming", category: "Intellectual", difficulty: "Hard", cost: "Free", desc: "The practice of becoming aware that you are dreaming while in a dream, allowing you to control the narrative." },
      { id: 14, title: "Bookbinding", category: "Craft", difficulty: "Medium", cost: "$$", desc: "The process of physically assembling a book of codex format from an ordered stack of paper sheets." },
      { id: 15, title: "SDR (Software Defined Radio)", category: "Tech", difficulty: "Medium", cost: "$$", desc: "Using a computer to receive and process radio signals. Listen to satellites, planes, and obscure frequencies." },
      { id: 16, title: "Hydroponics", category: "Nature", difficulty: "Medium", cost: "$$", desc: "Growing plants without soil, using mineral nutrient solutions in an aqueous solvent." },
      { id: 17, title: "Penspinning", category: "Skill", difficulty: "Hard", cost: "$", desc: "A form of object manipulation that involves the rhythmic manipulation of a writing instrument with one's hands." },
      { id: 18, title: "Speed Cubing", category: "Skill", difficulty: "Hard", cost: "$", desc: "Solving a Rubik's Cube or related puzzles as quickly as possible." },
      { id: 19, title: "Zine Making", category: "Art", difficulty: "Easy", cost: "$", desc: "Creating small-circulation self-published works of original or appropriated texts and images." },
      { id: 20, title: "Bouldering", category: "Physical", difficulty: "Hard", cost: "$$", desc: "Rock climbing stripped down to its raw essentials. No ropes or harnesses, just climbing shoes and a bag of chalk." },
      { id: 21, title: "Fermentation", category: "Culinary", difficulty: "Medium", cost: "$", desc: "Preserving food through the action of microorganisms. Think Kimchi, Kombucha, and Sauerkraut." },
      { id: 22, title: "Historical Fencing (HEMA)", category: "Physical", difficulty: "Hard", cost: "$$$", desc: "Reconstructing the lost martial arts of Europe using historical manuals." },
      { id: 23, title: "Bonsai", category: "Nature", difficulty: "Expert", cost: "$$", desc: "The Japanese art of growing and training miniature trees in containers." },
      { id: 24, title: "Origami", category: "Art", difficulty: "Medium", cost: "Free", desc: "The art of paper folding, which is often associated with Japanese culture." },
      { id: 25, title: "Dungeons & Dragons", category: "Social", difficulty: "Medium", cost: "$", desc: "A fantasy tabletop role-playing game where players form a party and embark on adventures." },
      { id: 26, title: "Creative Coding", category: "Tech", difficulty: "Medium", cost: "Free", desc: "Using code (like Processing or p5.js) to create expressive visuals and art rather than functional software." },
      { id: 27, title: "Calligraphy", category: "Art", difficulty: "Medium", cost: "$", desc: "A visual art related to writing. It is the design and execution of lettering with a broad-tipped instrument." },
      { id: 28, title: "Leatherworking", category: "Craft", difficulty: "Medium", cost: "$$", desc: "The practice of making items from leather using tools for shaping, coloring, and sewing." },
      { id: 29, title: "Amateur Radio (Ham)", category: "Tech", difficulty: "Hard", cost: "$$$", desc: "Using radio frequency spectrum for purposes of non-commercial exchange of messages and emergency communication." },
      { id: 30, title: "Genealogy", category: "Intellectual", difficulty: "Medium", cost: "Free", desc: "The study of families, family history, and the tracing of their lineages." },
      { id: 31, title: "Parkour", category: "Physical", difficulty: "Hard", cost: "Free", desc: "Getting from point A to point B as efficiently as possible using only the human body." },
      { id: 32, title: "Pyrography", category: "Craft", difficulty: "Medium", cost: "$", desc: "The free handed art of decorating wood or other materials with burn marks resulting from the controlled application of a heated object." },
      { id: 33, title: "Entomology", category: "Nature", difficulty: "Medium", cost: "Free", desc: "The scientific study of insects." },
      { id: 34, title: "Cardistry", category: "Skill", difficulty: "Hard", cost: "$", desc: "The performance art of card flourishing. Unlike magic, it's intended to be visually impressive and not deceptive." },
      { id: 35, title: "Memory Sports", category: "Intellectual", difficulty: "Hard", cost: "Free", desc: "Competitive memorization of playing cards, numbers, and names using techniques like the Mind Palace." },
      { id: 36, title: "Terrariums", category: "Nature", difficulty: "Easy", cost: "$", desc: "Creating miniature ecosystems inside sealed glass containers." },
      { id: 37, title: "Beatboxing", category: "Music", difficulty: "Medium", cost: "Free", desc: "A form of vocal percussion primarily involving the art of mimicking drum machines using one's mouth." },
      { id: 38, title: "Go (Weiqi)", category: "Intellectual", difficulty: "Expert", cost: "$", desc: "An abstract strategy board game for two players in which the aim is to surround more territory than the opponent." },
      { id: 39, title: "Linocut", category: "Art", difficulty: "Medium", cost: "$", desc: "A printmaking technique where a sheet of linoleum is used for a relief surface." },
      { id: 40, title: "Slacklining", category: "Physical", difficulty: "Medium", cost: "$", desc: "Walking or balancing along a suspended length of flat webbing that is tensioned between two anchors." },
      { id: 41, title: "Cosplay", category: "Art", difficulty: "Medium", cost: "$$", desc: "The practice of dressing up as a character from a movie, book, or video game." },
      { id: 42, title: "Randonauting", category: "Adventure", difficulty: "Easy", cost: "Free", desc: "Using a random coordinate generator to explore your local area with the intention of finding meaningful coincidences." },
      { id: 43, title: "Chess Composition", category: "Intellectual", difficulty: "Expert", cost: "Free", desc: "The art of creating chess problems. Distinct from playing chess, this is about designing puzzles." },
      { id: 44, title: "Aquascaping", category: "Nature", difficulty: "Hard", cost: "$$$", desc: "The craft of arranging aquatic plants, as well as rocks, stones, cavework, or driftwood, in an aesthetically pleasing manner within an aquarium." },
      { id: 45, title: "Solving ARG's", category: "Intellectual", difficulty: "Hard", cost: "Free", desc: "Alternate Reality Games. Interactive networked narratives that use the real world as a platform." },
      { id: 46, title: "Homebrewing", category: "Culinary", difficulty: "Medium", cost: "$$", desc: "The brewing of beer, mead, and ciders on a small scale for personal, non-commercial purposes." },
      { id: 47, title: "Tatting", category: "Craft", difficulty: "Medium", cost: "$", desc: "A technique for handcrafting a particularly durable lace from a series of knots and loops." },
      { id: 48, title: "Birdwatching", category: "Nature", difficulty: "Easy", cost: "Free", desc: "Observation of birds as a recreational activity or citizen science." },
      { id: 49, title: "Speedrunning", category: "Gaming", difficulty: "Expert", cost: "$", desc: "Playing a video game, or section of a game, with the goal of completing it as fast as possible." },
      { id: 50, title: "Worldbuilding", category: "Creative", difficulty: "Medium", cost: "Free", desc: "The process of constructing an imaginary world, sometimes associated with a whole fictional universe." },
      { id: 51, title: "Upcycling", category: "Craft", difficulty: "Easy", cost: "Free", desc: "Creative reuse. Transforming by-products, waste materials, useless, or unwanted products into new materials." },
      { id: 52, title: "Dumpster Diving", category: "Adventure", difficulty: "Easy", cost: "Free", desc: "Salvaging waste in large commercial, residential, industrial and construction containers." },
      { id: 53, title: "Yo-yoing", category: "Skill", difficulty: "Medium", cost: "$", desc: "Modern yo-yoing involves complex string tricks and mounts, far beyond the simple 'up and down'." },
      { id: 54, title: "Disc Golf", category: "Physical", difficulty: "Easy", cost: "$", desc: "A flying disc sport in which players throw a disc at a target; it is played using rules similar to golf." },
      { id: 55, title: "Tufting", category: "Craft", difficulty: "Medium", cost: "$$$", desc: "A type of textile weaving in which a thread is inserted on a primary base. Often used to make custom rugs." },
      { id: 56, title: "Drone Racing", category: "Tech", difficulty: "Hard", cost: "$$$", desc: "Piloting FPV (First Person View) drones at high speeds through obstacle courses." },
      { id: 57, title: "Letterboxing", category: "Adventure", difficulty: "Easy", cost: "$", desc: "An outdoor hobby that combines artistic ability with 'treasure hunts' in parks, forests, and cities." },
      { id: 58, title: "Lapidary", category: "Craft", difficulty: "Hard", cost: "$$$", desc: "The art of cutting and polishing stone. Creating gems, cabochons, and faceted stones." },
      { id: 59, title: "Stereoscopy", category: "Tech", difficulty: "Medium", cost: "$", desc: "A technique for creating or enhancing the illusion of depth in an image by means of stereopsis for binocular vision." },
      { id: 60, title: "Blacksmithing", category: "Craft", difficulty: "Hard", cost: "$$$", desc: "Creating objects from wrought iron or steel by forging the metal, using tools to hammer, bend, and cut." },
      { id: 61, title: "Poi", category: "Skill", difficulty: "Medium", cost: "$", desc: "A performance art, involving swinging tethered weights through a variety of rhythmical and geometric patterns." },
      { id: 62, title: "Microscopy", category: "Science", difficulty: "Medium", cost: "$$", desc: "Exploring the microscopic world. Water bears, plant cells, and crystals look alien under a lens." },
      { id: 63, title: "Foraging", category: "Nature", difficulty: "Medium", cost: "Free", desc: "Searching for wild food resources. It affects one's affect by reuniting them with the natural world." },
      { id: 64, title: "Book Nook Making", category: "Craft", difficulty: "Medium", cost: "$$", desc: "Creating miniature dioramas that sit between books on a bookshelf, often depicting an alleyway or fantasy scene." },
      { id: 65, title: "Fossil Hunting", category: "Nature", difficulty: "Medium", cost: "Free", desc: "Searching for fossils in sedimentary rock formations. A journey into deep time." },
      { id: 66, title: "Calisthenics", category: "Physical", difficulty: "Medium", cost: "Free", desc: "Exercises consisting of a variety of gross motor movements running, standing, grasping, pushing, etc. using body weight." },
      { id: 67, title: "Needle Felting", category: "Craft", difficulty: "Easy", cost: "$", desc: "Matting wool fibers together using a special barbed needle to create 3D sculptures." },
      { id: 68, title: "Soap Making", category: "Craft", difficulty: "Medium", cost: "$", desc: "The process of making soap from fats and lye (saponification). Endless possibilities for scents and designs." },
      { id: 69, title: "Candle Making", category: "Craft", difficulty: "Easy", cost: "$", desc: "Creating candles using various waxes, wicks, scents, and dyes." },
      { id: 70, title: "3D Printing", category: "Tech", difficulty: "Medium", cost: "$$", desc: "Constructing three-dimensional objects from a CAD model or a digital 3D model." },
      { id: 71, title: "Arduino/Raspberry Pi", category: "Tech", difficulty: "Medium", cost: "$$", desc: "Building digital devices and interactive objects that can sense and control physical devices." },
      { id: 72, title: "Cosmetic Chemistry", category: "Science", difficulty: "Hard", cost: "$$", desc: "Formulating your own makeup, lotions, and skincare products." },
      { id: 73, title: "Cryptography", category: "Intellectual", difficulty: "Hard", cost: "Free", desc: "The practice and study of techniques for secure communication in the presence of adversarial behavior." },
      { id: 74, title: "People Watching", category: "Social", difficulty: "Easy", cost: "Free", desc: "The act of observing people and their interactions, usually without their knowledge." },
      { id: 75, title: "Kite Fighting", category: "Sport", difficulty: "Medium", cost: "$", desc: "Using a kite to cut the string of a rival kite. Popular in Afghanistan, Brazil, India, Pakistan, Vietnam, Korea." },
      { id: 76, title: "Chainmaille", category: "Craft", difficulty: "Medium", cost: "$$", desc: "Linking metal rings together to create mesh, jewelry, or armor." },
      { id: 77, title: "Guerilla Gardening", category: "Nature", difficulty: "Easy", cost: "$", desc: "Gardening on land that the gardeners do not have the legal rights to cultivate, such as abandoned sites." },
      { id: 78, title: "Highpointing", category: "Outdoors", difficulty: "Hard", cost: "$$", desc: "The sport of ascending to the point with the highest elevation within a given area (usually US states)." },
      { id: 79, title: "Metal Detecting", category: "Outdoors", difficulty: "Easy", cost: "$$", desc: "Using an electronic instrument to find metal inclusions hidden within objects, or metal objects buried underground." },
      { id: 80, title: "Speed Reading", category: "Skill", difficulty: "Medium", cost: "Free", desc: "Techniques used to improve one's ability to read quickly." },
      { id: 81, title: "Taxidermy", category: "Science", difficulty: "Expert", cost: "$$", desc: "The art of preparing, stuffing, and mounting the skins of animals with lifelike effect." },
      { id: 82, title: "Clock Repair", category: "Tech", difficulty: "Expert", cost: "$$", desc: "Horology. The intricate mechanical world of gears, springs, and escapements." },
      { id: 83, title: "Juggling", category: "Skill", difficulty: "Medium", cost: "$", desc: "A physical skill, performed by a juggler, involving the manipulation of objects for recreation, entertainment, art or sport." },
      { id: 84, title: "Stained Glass", category: "Art", difficulty: "Hard", cost: "$$$", desc: "Creating colored glass windows or small works of art using lead came or copper foil." },
      { id: 85, title: "Perfume Making", category: "Art", difficulty: "Expert", cost: "$$$", desc: "Blending essential oils and aroma compounds to create unique fragrances." },
      { id: 86, title: "Tea Tasting", category: "Culinary", difficulty: "Easy", cost: "$$", desc: "Gongfu tea ceremony or simply learning to distinguish between varieties of Camellia sinensis." },
      { id: 87, title: "Lino Printing", category: "Art", difficulty: "Medium", cost: "$", desc: "A variant of woodcut in which a sheet of linoleum is used for the relief surface." },
      { id: 88, title: "Wiki Racing", category: "Intellectual", difficulty: "Easy", cost: "Free", desc: "A game where players start on one Wikipedia article and try to reach another through the fewest number of clicks." },
      { id: 89, title: "Pen Pal", category: "Social", difficulty: "Easy", cost: "$", desc: "Writing letters to strangers around the world. Slow communication in a fast world." },
      { id: 90, title: "Prop Making", category: "Craft", difficulty: "Medium", cost: "$$", desc: "Building props for film, theater, or cosplay. Involves painting, sculpting, and engineering." },
      { id: 91, title: "Storm Chasing", category: "Adventure", difficulty: "Expert", cost: "$$$", desc: "The pursuit of any severe weather condition, regardless of motive." },
      { id: 92, title: "Competitive Duck Herding", category: "Niche", difficulty: "Medium", cost: "$$", desc: "Using sheepdogs to guide ducks around a course. Yes, it is a real thing." },
      { id: 93, title: "Extreme Ironing", category: "Niche", difficulty: "Hard", cost: "$", desc: "Taking an ironing board to a remote location and ironing clothes. 'The latest danger sport that combines the thrills of an extreme outdoor activity with the satisfaction of a well-pressed shirt.'" },
      { id: 94, title: "Toy Voyaging", category: "Social", difficulty: "Easy", cost: "$", desc: "Sending a toy on a trip around the world by passing it from person to person." },
      { id: 95, title: "Postcrossing", category: "Social", difficulty: "Easy", cost: "$", desc: "A project that allows you to send postcards and receive postcards back from random people around the world." },
      { id: 96, title: "Herping", category: "Nature", difficulty: "Medium", cost: "Free", desc: "Searching for reptiles and amphibians. Similar to birding but for snakes, frogs, and lizards." },
      { id: 97, title: "Digiscoping", category: "Tech", difficulty: "Medium", cost: "$$", desc: "Taking photos through a spotting scope or binoculars." },
      { id: 98, title: "Fell Running", category: "Physical", difficulty: "Hard", cost: "Free", desc: "Running and racing off-road, over upland country where the gradient is a significant component." },
      { id: 99, title: "Mushroom Cultivation", category: "Nature", difficulty: "Medium", cost: "$$", desc: "Growing edible or medicinal mushrooms at home using substrate bags or logs." },
      { id: 100, title: "Glitch Art", category: "Art", difficulty: "Medium", cost: "Free", desc: "The practice of using digital or analog errors for aesthetic purposes by corrupting digital data or physically manipulating electronic devices." }
    ];

    // --- STATE ---
    const state = {
        searchTerm: '',
        activeTab: 'All',
        viewMode: 'grid', // 'grid' | 'stumble'
        savedIds: [],
        stumbleIndex: 0
    };

    // --- HELPERS ---
    const getGradient = (cat) => {
        const map = {
            'Skill': 'from-blue-500 to-cyan-500',
            'Nature': 'from-green-500 to-emerald-500',
            'Tech': 'from-violet-500 to-purple-500',
            'Art': 'from-pink-500 to-rose-500',
            'Craft': 'from-amber-500 to-orange-500',
            'Physical': 'from-red-500 to-orange-500',
            'Intellectual': 'from-indigo-500 to-blue-500',
            'Social': 'from-yellow-400 to-orange-500',
            'Adventure': 'from-teal-500 to-green-500',
            'Culinary': 'from-orange-500 to-red-500',
            'Niche': 'from-fuchsia-500 to-pink-500',
            'Gaming': 'from-purple-600 to-indigo-600',
            'Music': 'from-sky-500 to-blue-600',
            'Sport': 'from-emerald-500 to-teal-600',
            'Creative': 'from-rose-400 to-pink-500',
            'Science': 'from-cyan-500 to-blue-500',
        };
        return map[cat] || 'from-slate-500 to-slate-400';
    };

    const getEmoji = (cat) => {
        const map = {
            'Skill': 'âš¡', 'Nature': 'ðŸŒ¿', 'Tech': 'ðŸ¤–', 'Art': 'ðŸŽ¨', 
            'Craft': 'ðŸ§¶', 'Physical': 'ðŸ’ª', 'Intellectual': 'ðŸ§ ', 'Social': 'ðŸ’¬',
            'Adventure': 'ðŸ—ºï¸', 'Culinary': 'ðŸ³', 'Niche': 'ðŸ¦„', 'Gaming': 'ðŸŽ®',
            'Music': 'ðŸŽµ', 'Sport': 'âš½', 'Creative': 'âœ¨', 'Science': 'ðŸ”¬'
        };
        return map[cat] || 'ðŸ“¦';
    };

    const getDifficultyColor = (diff) => {
        if (diff === 'Easy') return 'bg-emerald-400';
        if (diff === 'Medium') return 'bg-amber-400';
        if (diff === 'Hard') return 'bg-orange-400';
        if (diff === 'Expert') return 'bg-rose-500';
        return 'bg-slate-400';
    };

    // --- FILTERING ---
    const getFilteredItems = () => {
        let items = RAW_INTERESTS;
        
        // Filter by Tab
        if (state.activeTab === 'saved') {
            items = items.filter(i => state.savedIds.includes(i.id));
        } else if (state.activeTab !== 'All') {
            items = items.filter(i => i.category === state.activeTab);
        }

        // Filter by Search
        if (state.searchTerm) {
            const lower = state.searchTerm.toLowerCase();
            items = items.filter(i => 
                i.title.toLowerCase().includes(lower) || 
                i.desc.toLowerCase().includes(lower) ||
                i.category.toLowerCase().includes(lower)
            );
        }
        
        return items;
    };

    // --- ACTIONS ---
    const updateSearch = (val) => {
        state.searchTerm = val;
        render();
    };

    const setViewMode = (mode) => {
        state.viewMode = mode;
        render();
    };

    const setActiveTab = (tab) => {
        state.activeTab = tab;
        render();
    };

    const toggleSaved = (id) => {
        const index = state.savedIds.indexOf(id);
        if (index > -1) {
            state.savedIds.splice(index, 1);
        } else {
            state.savedIds.push(id);
        }
        localStorage.setItem('rabbitHoleSaved', JSON.stringify(state.savedIds));
        render();
        // Update modal heart if open
        const modalBtn = document.getElementById('modal-heart-btn');
        if (modalBtn) {
            const isSaved = state.savedIds.includes(id);
            modalBtn.innerHTML = `<i data-lucide="heart" class="${isSaved ? 'fill-current' : ''} w-6 h-6"></i>`;
            modalBtn.className = `p-2 rounded-full transition-all ${isSaved ? 'bg-rose-600/20 text-rose-500' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}`;
            lucide.createIcons();
        }
    };

    const nextStumble = () => {
        const filtered = getFilteredItems();
        if (filtered.length > 0) {
             state.stumbleIndex = Math.floor(Math.random() * filtered.length);
             render();
        }
    };

    const openModal = (id) => {
        const item = RAW_INTERESTS.find(i => i.id === id);
        if (!item) return;

        const isSaved = state.savedIds.includes(item.id);
        const container = document.getElementById('modal-container');
        const content = document.getElementById('modal-content');

        content.innerHTML = `
             <div class="h-32 w-full bg-gradient-to-br ${getGradient(item.category)} relative">
                <button 
                  onclick="closeModal()"
                  class="absolute top-4 right-4 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white backdrop-blur-md transition-colors"
                >
                  <i data-lucide="x" class="w-5 h-5"></i>
                </button>
                <div class="absolute -bottom-8 left-6">
                  <div class="h-16 w-16 rounded-xl bg-slate-800 flex items-center justify-center shadow-lg border-4 border-slate-900 text-3xl">
                    ${getEmoji(item.category)}
                  </div>
                </div>
              </div>

              <div class="px-6 pt-10 pb-6">
                <div class="flex justify-between items-start">
                  <div>
                    <h3 class="text-2xl font-bold text-white leading-6">${item.title}</h3>
                    <span class="inline-flex mt-2 items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-800 text-slate-300 border border-slate-700">
                      ${item.category}
                    </span>
                  </div>
                  <button 
                    id="modal-heart-btn"
                    onclick="toggleSaved(${item.id})"
                    class="p-2 rounded-full transition-all ${isSaved ? 'bg-rose-600/20 text-rose-500' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}"
                  >
                    <i data-lucide="heart" class="${isSaved ? 'fill-current' : ''} w-6 h-6"></i>
                  </button>
                </div>

                <div class="mt-4 prose prose-invert">
                  <p class="text-slate-300 text-lg leading-relaxed">
                    ${item.desc}
                  </p>
                </div>

                <div class="mt-6 grid grid-cols-2 gap-4">
                  <div class="bg-slate-800/50 p-3 rounded-lg border border-slate-700/50">
                    <span class="text-xs text-slate-500 uppercase font-bold tracking-wider">Difficulty</span>
                    <div class="mt-1 flex items-center space-x-2">
                      <div class="h-2 w-2 rounded-full ${getDifficultyColor(item.difficulty)}"></div>
                      <span class="text-slate-200 font-medium">${item.difficulty}</span>
                    </div>
                  </div>
                  <div class="bg-slate-800/50 p-3 rounded-lg border border-slate-700/50">
                    <span class="text-xs text-slate-500 uppercase font-bold tracking-wider">Cost</span>
                    <div class="mt-1 text-slate-200 font-medium tracking-widest">${item.cost}</div>
                  </div>
                </div>

                <div class="mt-8 flex space-x-3">
                  <a href="https://www.google.com/search?q=${encodeURIComponent('how to start ' + item.title)}" target="_blank" class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white py-3 px-4 rounded-xl font-medium transition-all shadow-lg shadow-indigo-500/20 flex items-center justify-center space-x-2 no-underline">
                    <span>Google This</span>
                    <i data-lucide="arrow-right" class="w-4 h-4"></i>
                  </a>
                   <a 
                    href="https://www.youtube.com/results?search_query=${encodeURIComponent('how to start ' + item.title)}" target="_blank"
                    class="flex-1 bg-slate-800 hover:bg-slate-700 text-white py-3 px-4 rounded-xl font-medium transition-all border border-slate-700 flex items-center justify-center space-x-2 no-underline"
                  >
                    <span>Watch Video</span>
                    <i data-lucide="maximize" class="w-4 h-4"></i>
                  </a>
                </div>
              </div>
        `;
        
        container.classList.remove('hidden');
        lucide.createIcons();
    };

    const closeModal = () => {
        document.getElementById('modal-container').classList.add('hidden');
    };

    // --- RENDERERS ---

    const renderHeader = () => {
        const cats = ['All', 'Skill', 'Nature', 'Tech', 'Art', 'Craft', 'Intellectual', 'Physical', 'Culinary', 'Social', 'Adventure', 'Niche'];
        
        let catButtons = '';
        if (state.viewMode === 'grid' && state.activeTab !== 'saved') {
            catButtons = `
            <div class="flex overflow-x-auto pb-4 pt-2 gap-2 scrollbar-hide">
              ${cats.map(cat => `
                <button
                  onclick="setActiveTab('${cat}')"
                  class="whitespace-nowrap px-4 py-1.5 rounded-full text-sm font-medium transition-all duration-200 border ${
                    state.activeTab === cat
                      ? 'bg-slate-100 text-slate-900 border-slate-100'
                      : 'bg-slate-800/50 text-slate-400 border-slate-700 hover:border-slate-500 hover:text-white'
                  }"
                >
                  ${cat}
                </button>
              `).join('')}
            </div>
            `;
        }

        return `
          <div class="sticky top-0 z-50 bg-slate-900/90 backdrop-blur-md border-b border-slate-800 shadow-xl">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
              <div class="flex flex-col md:flex-row items-center justify-between py-4 space-y-4 md:space-y-0">
                
                <!-- Logo -->
                <div class="flex items-center space-x-3 w-full md:w-auto">
                  <div class="p-2 bg-indigo-600 rounded-lg shadow-lg shadow-indigo-500/30">
                    <i data-lucide="book-open" class="text-white w-6 h-6"></i>
                  </div>
                  <div>
                    <h1 class="text-xl font-bold text-white tracking-tight">The Rabbit Hole</h1>
                    <p class="text-xs text-slate-400 font-medium">Explore ${RAW_INTERESTS.length} curiosities</p>
                  </div>
                </div>

                <!-- Search -->
                <div class="relative w-full md:w-96 group">
                  <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <i data-lucide="search" class="h-5 w-5 text-slate-500 group-focus-within:text-indigo-400 transition-colors"></i>
                  </div>
                  <input
                    type="text"
                    value="${state.searchTerm}"
                    oninput="updateSearch(this.value)"
                    class="block w-full pl-10 pr-3 py-2 border border-slate-700 rounded-full leading-5 bg-slate-800 text-slate-100 placeholder-slate-500 focus:outline-none focus:bg-slate-900 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 sm:text-sm transition-all shadow-inner"
                    placeholder="Search hobbies, skills, topics..."
                  />
                </div>

                <!-- Controls -->
                <div class="flex items-center space-x-2 w-full md:w-auto justify-end">
                  <button 
                    onclick="setViewMode('grid')"
                    class="p-2 rounded-lg transition-all ${state.viewMode === 'grid' ? 'bg-indigo-600 text-white shadow-lg shadow-indigo-500/20' : 'text-slate-400 hover:bg-slate-800'}"
                    title="Grid View"
                  >
                    <i data-lucide="grid" class="w-5 h-5"></i>
                  </button>
                  <button 
                    onclick="setViewMode('stumble')"
                    class="p-2 rounded-lg transition-all ${state.viewMode === 'stumble' ? 'bg-fuchsia-600 text-white shadow-lg shadow-fuchsia-500/20' : 'text-slate-400 hover:bg-slate-800'}"
                    title="Stumble Mode"
                  >
                    <i data-lucide="shuffle" class="w-5 h-5"></i>
                  </button>
                  <button 
                    onclick="setActiveTab('saved')"
                    class="p-2 rounded-lg transition-all flex items-center space-x-2 ${state.activeTab === 'saved' ? 'bg-rose-600 text-white shadow-lg shadow-rose-500/20' : 'text-slate-400 hover:bg-slate-800'}"
                    title="My Saved Items"
                  >
                    <i data-lucide="heart" class="w-5 h-5 ${state.activeTab === 'saved' ? 'fill-current' : ''}"></i>
                  </button>
                </div>
              </div>
              
              ${catButtons}
            </div>
          </div>
        `;
    };

    const renderCard = (item) => {
        const isSaved = state.savedIds.includes(item.id);
        return `
          <div 
            onclick="openModal(${item.id})"
            class="group relative bg-slate-800 rounded-2xl p-6 hover:bg-slate-750 border border-slate-700 hover:border-indigo-500/50 transition-all duration-300 hover:shadow-2xl hover:shadow-indigo-500/10 cursor-pointer flex flex-col h-full overflow-hidden"
          >
            <!-- Abstract Background Decoration -->
            <div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br ${getGradient(item.category)} opacity-10 rounded-bl-full -mr-10 -mt-10 transition-opacity group-hover:opacity-20"></div>

            <div class="flex justify-between items-start mb-4 relative z-10">
              <div class="h-12 w-12 rounded-xl bg-slate-900 border border-slate-700 flex items-center justify-center text-2xl shadow-sm group-hover:scale-110 transition-transform duration-300">
                ${getEmoji(item.category)}
              </div>
              <button 
                onclick="event.stopPropagation(); toggleSaved(${item.id});"
                class="p-2 rounded-full transition-all ${isSaved ? 'opacity-100 text-rose-500' : 'opacity-0 group-hover:opacity-100 text-slate-500 hover:bg-slate-700 hover:text-rose-400'}"
              >
                <i data-lucide="heart" class="w-5 h-5 ${isSaved ? 'fill-current' : ''}"></i>
              </button>
            </div>
            
            <div class="flex-1 relative z-10">
              <h3 class="text-lg font-bold text-white mb-2 line-clamp-1 group-hover:text-indigo-300 transition-colors">${item.title}</h3>
              <p class="text-sm text-slate-400 line-clamp-3 leading-relaxed">${item.desc}</p>
            </div>

            <div class="mt-4 pt-4 border-t border-slate-700/50 flex items-center justify-between text-xs font-medium text-slate-500 relative z-10">
              <span class="flex items-center space-x-1.5">
                <span class="w-1.5 h-1.5 rounded-full ${getDifficultyColor(item.difficulty)}"></span>
                <span>${item.difficulty}</span>
              </span>
              <span>${item.cost}</span>
            </div>
          </div>
        `;
    };

    const renderEmptyState = () => {
        return `
          <div class="flex flex-col items-center justify-center py-20 text-center col-span-full">
            <div class="p-4 bg-slate-900 rounded-full mb-4">
              <i data-lucide="trophy" class="text-slate-600 w-12 h-12"></i>
            </div>
            <h3 class="text-xl font-medium text-white">No interests found</h3>
            <p class="text-slate-400 mt-2 max-w-sm">
              ${state.activeTab === 'saved' 
                ? "You haven't saved any interests yet. Go explore and heart the ones you like!" 
                : "Try adjusting your search terms or filters."}
            </p>
            ${state.activeTab === 'saved' ? `
              <button 
                onclick="setActiveTab('All')"
                class="mt-6 px-6 py-2 bg-indigo-600 text-white rounded-full font-medium hover:bg-indigo-700 transition-colors"
              >
                Start Exploring
              </button>
            ` : ''}
          </div>
        `;
    };

    const renderStumble = (item, filteredCount) => {
        if (!item) return renderEmptyState();
        const isSaved = state.savedIds.includes(item.id);
        
        return `
          <div class="flex flex-col items-center justify-center min-h-[70vh] slide-up">
            <div class="w-full max-w-2xl">
              <div class="bg-slate-900 border border-slate-800 rounded-3xl p-8 md:p-12 shadow-2xl relative overflow-hidden">
                <!-- Background glow -->
                <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r ${getGradient(item.category)}"></div>
                
                <div class="flex justify-between items-start mb-8">
                   <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-slate-800 text-slate-300 border border-slate-700">
                    ${item.category}
                  </span>
                  <button 
                    onclick="toggleSaved(${item.id})"
                    class="p-3 rounded-full bg-slate-800 border border-slate-700 transition-all ${isSaved ? 'text-rose-500' : 'text-slate-400 hover:text-white'}"
                  >
                    <i data-lucide="heart" class="w-6 h-6 ${isSaved ? 'fill-current' : ''}"></i>
                  </button>
                </div>

                <div class="text-center mb-10">
                  <div class="inline-flex items-center justify-center h-24 w-24 rounded-2xl bg-slate-800 text-6xl mb-6 shadow-xl border border-slate-700">
                    ${getEmoji(item.category)}
                  </div>
                  <h2 class="text-4xl md:text-5xl font-black text-white mb-6 tracking-tight">${item.title}</h2>
                  <p class="text-xl text-slate-400 leading-relaxed max-w-lg mx-auto">
                    ${item.desc}
                  </p>
                </div>

                <div class="grid grid-cols-2 gap-4 mb-8 max-w-md mx-auto">
                   <div class="bg-slate-800/50 p-4 rounded-xl text-center">
                    <span class="text-xs text-slate-500 uppercase font-bold tracking-wider">Difficulty</span>
                    <div class="mt-1 text-slate-200 font-bold">${item.difficulty}</div>
                  </div>
                   <div class="bg-slate-800/50 p-4 rounded-xl text-center">
                    <span class="text-xs text-slate-500 uppercase font-bold tracking-wider">Cost</span>
                    <div class="mt-1 text-slate-200 font-bold">${item.cost}</div>
                  </div>
                </div>

                <div class="flex justify-center space-x-4">
                  <button 
                    onclick="openModal(${item.id})"
                    class="px-8 py-4 bg-slate-800 hover:bg-slate-700 text-white rounded-xl font-bold transition-all border border-slate-700 flex items-center space-x-2"
                  >
                    <i data-lucide="maximize" class="w-5 h-5"></i>
                    <span>Details</span>
                  </button>
                  <button 
                    onclick="nextStumble()"
                    class="px-8 py-4 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold transition-all shadow-lg shadow-indigo-500/25 flex items-center space-x-2 transform active:scale-95"
                  >
                    <i data-lucide="dice-5" class="w-5 h-5"></i>
                    <span>Spin Again</span>
                  </button>
                </div>
              </div>
              <p class="text-center text-slate-500 mt-6 text-sm">
                Showing ${state.stumbleIndex + 1} of ${filteredCount} filtered items
              </p>
            </div>
          </div>
        `;
    }

    const render = () => {
        const app = document.getElementById('app');
        const filtered = getFilteredItems();
        
        let mainContent = '';

        if (state.viewMode === 'grid') {
            const gridContent = filtered.length 
                ? `<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 fade-in">
                    ${filtered.map(renderCard).join('')}
                   </div>`
                : renderEmptyState();
            
            mainContent = `
                <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">
                    ${gridContent}
                </main>
            `;
        } else {
            // Stumble Logic
            const stumbleItem = filtered.length > 0 ? filtered[state.stumbleIndex % filtered.length] : null;
            mainContent = `
                <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">
                    ${renderStumble(stumbleItem, filtered.length)}
                </main>
            `;
        }

        app.innerHTML = `
            ${renderHeader()}
            ${mainContent}
        `;

        lucide.createIcons();
    };

    // --- INIT ---
    const init = () => {
        const saved = localStorage.getItem('rabbitHoleSaved');
        if (saved) state.savedIds = JSON.parse(saved);
        render();
    };

    init();

</script>
</body>
</html>
